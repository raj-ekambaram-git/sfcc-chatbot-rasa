version: "2.0"

rules:
  - rule: welcome user
    conversation_start: true
    steps:
      - intent: welcome
      - action: action_welcome_user

  - rule: greet anytime the user greets
    steps:
      - intent: greet
      - action: action_greet_user
      - action: utter_popular_questions

  - rule: respond when user ask for help
    steps:
      - intent: ask_help
      - action: utter_help

  - rule: say goodbye anytime the user says goodbye / thanks
    steps:
      - or:
          - intent: goodbye
          - intent: thankyou
      - action: utter_goodbye

  - rule: end feedback form
    condition:
      - active_loop: feedback_form
    steps:
      - action: feedback_form
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - action: action_save_feedback
      - action: utter_thanks
      - action: action_restart

  - rule: respond to chitchat
    steps:
      - intent: chitchat
      - action: utter_chitchat

  - rule: Ask the user to rephrase whenever they send a message with low NLU confidence
    steps:
      - intent: nlu_fallback
      - action: utter_default
